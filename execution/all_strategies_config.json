{
  "strategy_weights": {
    "size": 0.0500,
    "breakout": 0.0911,
    "beta": 0.0825,
    "mean_reversion": 0.0500,
    "carry": 0.0500,
    "volatility": 0.1436,
    "kurtosis": 0.0500,
    "days_from_high": 0.0500,
    "adf": 0.0500,
    "trendline_breakout": 0.0,
    "leverage_inverted": 0.3328,
    "dilution": 0.0500,
    "turnover": 0.1000
  },
  "_weights_note": {
    "_comment": "ENSEMBLE METHOD: Robust portfolio weights optimized using ensemble averaging (Regularized MVO + Risk Parity + Max Diversification). 30% more stable than standard MVO.",
    "_optimization_method": "Ensemble (Avg of Regularized MVO, Risk Parity, Max Diversification)",
    "_stability_improvement": "30% reduction in portfolio turnover vs standard MVO (16.6% vs 23.7%)",
    "_backtest_period": "2021-01-01 to 2025-10-24 (4.8 years)",
    "_portfolio_sharpe": 1.709,
    "_expected_return": "13.70%",
    "_expected_volatility": "8.02%",
    "_expected_max_drawdown": "-38%",
    "_reason": "Ensemble method provides optimal balance of stability and performance. Leverage Inverted (33.28%) dominates due to low correlation and consistent returns. Volatility Factor (14.36%) provides strong risk-adjusted returns. All other strategies maintain 5% minimum for diversification.",
    "_capped_strategies": {
      "size": "5% (negative Sharpe: -0.41, capped)",
      "mean_reversion": "5% (negative Sharpe: -0.16, capped)",
      "carry": "5% (negative Sharpe: -0.03, capped)",
      "kurtosis": "5% (regime-dependent: bear_only, capped)",
      "days_from_high": "5% (negative Sharpe: -0.51, capped)",
      "adf": "5% (negative Sharpe: -0.03, capped)",
      "dilution": "5% (high volatility, capped for safety)",
      "trendline_breakout": "0% (not included in analysis)"
    },
    "_methodology": {
      "_shrinkage": "Applied James-Stein (returns) and Ledoit-Wolf (covariance) shrinkage to reduce estimation error",
      "_regularization": "L2 penalty (lambda=0.5) to discourage extreme allocations",
      "_diversification": "5% minimum weight floor ensures broad diversification"
    }
  },
  "_weights_updated_history": {
    "_2025_11_02_ENSEMBLE_ROBUST": {
      "_comment": "CURRENT - ENSEMBLE METHOD: Robust weights using ensemble optimization (Regularized MVO + Risk Parity + Max Diversification). 30% more stable than standard MVO.",
      "_date": "2025-11-02",
      "_optimization_method": "Ensemble (Average of 3 methods)",
      "_active_strategies": "Leverage_Inverted (33.28%), Volatility (14.36%), Breakout (9.11%), Beta (8.25%), All others (5.00% minimum)",
      "_portfolio_metrics": {
        "sharpe": 1.709,
        "expected_return": "13.70%",
        "volatility": "8.02%",
        "max_drawdown": "-38%",
        "turnover_stability": "30% improvement vs standard MVO"
      },
      "_key_changes": {
        "leverage_inverted": "5% ? 33.28% (largest allocation, low correlation diversifier)",
        "volatility": "5.63% ? 14.36% (high Sharpe 1.08, proven performer)",
        "size": "22.49% ? 5.00% (negative Sharpe -0.41, capped)",
        "adf": "21.85% ? 5.00% (negative Sharpe -0.03, capped)",
        "beta": "16.17% ? 8.25% (moderate allocation)",
        "breakout": "14.86% ? 9.11% (reduced but still meaningful)"
      },
      "_stability_analysis": {
        "full_period_vs_3mo_turnover": "16.60%",
        "standard_mvo_turnover": "23.66%",
        "improvement": "30% reduction in turnover",
        "method_stability_rating": "4/5 stars"
      },
      "_documentation": "See docs/MVO_STABILITY_SOLUTIONS.md for full analysis"
    },
    "_2025_11_02_TESTING_LEVERAGE_DILUTION": {
      "_comment": "OLD - TESTING VERSION: Added leverage_inverted (5%) and dilution (5%) for testing. Core MVO strategies scaled to 90% to accommodate. Original MVO weights preserved at 90% scale.",
      "_date": "2025-11-02",
      "_active_strategies": "Size (22.49%), ADF (21.85%), Beta (16.17%), Breakout (14.86%), Volatility (5.63%), Leverage_Inverted (5.00% TESTING), Dilution (5.00% TESTING), Kurtosis (4.50%, regime-dependent), Mean Reversion (4.50%)",
      "_testing_note": "This is a testing configuration. Leverage_inverted and dilution are experimental strategies capped at 5% for safety.",
      "_optimization_constraint": "Testing strategies capped at 5% max, core MVO strategies scaled proportionally"
    },
    "_2025_11_02_MVO_V3_WITH_ADF": {
      "_comment": "OLD - MVO optimization with ADF included. 5% caps on negative/regime-dependent strategies. Backtest period: 2023-2025.",
      "_date": "2025-11-02",
      "_active_strategies": "Size (24.99%, Sharpe 0.70), ADF (24.28%, Sharpe 0.46), Beta (17.97%, Sharpe 0.56), Breakout (16.51%, Sharpe 0.46), Volatility (6.25%, Sharpe 0.32), Kurtosis (5.00%, Sharpe 0.68, CAPPED), Mean Reversion (5.00%, Sharpe -0.03, CAPPED)",
      "_excluded_strategies": "Days from High (0%, Sharpe -0.24), Carry (0%, Sharpe -0.81), Trendline Breakout (not analyzed)",
      "_optimization_constraint": "Negative Sharpe strategies capped at 5%, regime-dependent strategies (Kurtosis) capped at 5%",
      "_portfolio_metrics": {
        "sharpe": 1.424,
        "return": "14.78%",
        "volatility": "10.38%",
        "max_drawdown": "-29.77%"
      },
      "_correlation_analysis": {
        "adf_diversification": "Low correlation with Size (0.007), Beta (-0.049), and Volatility (-0.135) - excellent diversifier",
        "adf_allocation": "Second largest holding at 24.28%, co-equal with Size. Provides trend-following premium exposure.",
        "kurtosis_note": "Positive Sharpe but regime-dependent (bear_only), capped at 5% for risk management"
      }
    },
    "_2025_11_02_MVO_V2_NO_ADF": {
      "_comment": "OLD - MVO optimization with 5% caps on negative/regime-dependent strategies. Backtest period: 2023-2025. ADF had backtest error.",
      "_date": "2025-11-02",
      "_active_strategies": "Size (36.00%, Sharpe 0.70), Breakout (25.77%, Sharpe 0.46), Beta (23.72%, Sharpe 0.56), Kurtosis (5.00%, Sharpe 0.68, CAPPED), Mean Reversion (5.00%, Sharpe -0.03, CAPPED), Volatility (3.98%, Sharpe 0.32), Days from High (0.52%, Sharpe -0.24, CAPPED)",
      "_excluded_strategies": "Carry (0%, Sharpe -0.81, worst performer), ADF (backtest error), Trendline Breakout (not analyzed)",
      "_optimization_constraint": "Negative Sharpe strategies capped at 5%, regime-dependent strategies (Kurtosis) capped at 5%",
      "_portfolio_metrics": {
        "sharpe": 1.284,
        "return": "16.30%",
        "volatility": "12.70%",
        "max_drawdown": "-30.72%"
      },
      "_correlation_analysis": {
        "breakout_diversification": "Near-zero correlation with Size (0.028) and Beta (0.012) - excellent diversifier",
        "volatility_correlation": "High correlation with Beta (0.570), included at 3.98% for additional diversification",
        "kurtosis_note": "Positive Sharpe but regime-dependent (bear_only), capped at 5% for risk management"
      }
    },
    "_2025_11_02_MVO_V1": {
      "_comment": "OLD - Mean-Variance Optimization with correlation penalty. Portfolio optimized for maximum Sharpe ratio.",
      "_active_strategies": "Size (45.43%, Sharpe 0.70), Breakout (32.23%, Sharpe 0.46), Beta (22.34%, Sharpe 0.56)",
      "_excluded_strategies": "Volatility (0%, Sharpe 0.32, excluded due to 0.570 correlation with Beta), Mean Reversion (0%, Sharpe -0.032), Carry (0%, Sharpe -0.813), Kurtosis (0%, Sharpe -0.848), Days from High (0%, Sharpe -0.241), ADF (0%, failed backtest), Trendline Breakout (0%, not analyzed)",
      "_optimization_constraint": "Volatility Factor capped at maximum 5%",
      "_portfolio_metrics": {
        "sharpe": 0.891,
        "return": "13.62%",
        "volatility": "15.29%",
        "max_drawdown": "-30.27%"
      },
      "_correlation_analysis": {
        "breakout_diversification": "Near-zero correlation with Size (0.028) and Beta (0.012) - excellent diversifier",
        "volatility_redundant": "High correlation with Beta (0.570) and Size (0.464) - not worth including"
      }
    },
    "_2025_11_02_OLD": {
      "_comment": "OLD WEIGHTS - Weights rebalanced based on 2023-2025 backtest results. Positive Sharpe strategies scaled up, negative Sharpe capped at 5%.",
      "_positive_sharpe": "Size=0.70, Beta=0.56, Breakout=0.46, Volatility=0.32",
      "_negative_sharpe": "Mean Reversion=-0.032 (CAPPED), Kurtosis=-0.85 (CAPPED), Carry=-1.04 (CAPPED), ADF=-0.85 (CAPPED)",
      "_total_positive_sharpe": 2.04
    },
    "_2025_10_30_OLD": {
      "_comment": "OLD WEIGHTS - Weights updated based on Sharpe ratios: Size=0.39, Carry=0.76, Mean Reversion=3.14, Beta=0.68, Volatility=1.41, TLBO=0.36, Kurtosis=0.85",
      "_date": "2025-10-30",
      "_total_sharpe": 7.59,
      "_note": "These weights included an error - Mean Reversion had incorrect Sharpe (3.14 vs actual -0.032)"
    }
  },
  "_removed_strategy": {
    "_comment": "oi_divergence strategy removed - OI data not used anymore",
    "_old_weight": 0.0676894017329385
  },
  "params": {
    "days_from_high": {
      "max_days": 20
    },
    "breakout": {
      "entry_lookback": 50,
      "exit_lookback": 70
    },
    "mean_reversion": {
      "zscore_threshold": 1.5,
      "volume_threshold": 1.0,
      "lookback_window": 30,
      "period_days": 2,
      "limit": 100,
      "long_only": true
    },
    "size": {
      "top_n": 10,
      "bottom_n": 10,
      "limit": 100,
      "rebalance_days": 10,
      "_comment": "Optimal rebalance frequency: 10 days (Sharpe: 0.39, Annual Return: 15.89%). Run strategy every 10 days for best risk-adjusted returns."
    },
    "carry": {
      "exchange_id": "hyperliquid",
      "top_n": 10,
      "bottom_n": 10,
      "rebalance_days": 7,
      "_comment": "Optimal rebalance frequency: 7 days (weekly). Medium-changing factor based on funding rates."
    },
    "beta": {
      "beta_window": 90,
      "volatility_window": 30,
      "rebalance_days": 5,
      "long_percentile": 10,
      "short_percentile": 90,
      "num_quintiles": 10,
      "weighting_method": "risk_parity",
      "long_allocation": 0.5,
      "short_allocation": 0.5,
      "_comment": "UPDATED 2025-11-04: Changed to DECILE (10%) with risk_parity. Backtest results: Sharpe 0.71, Total Return 261.38%, Ann Return 31.70%, MaxDD -39.27%. Decile approach captures beta anomaly more effectively than quintile (20%). Betting Against Beta: long low-beta coins, short high-beta coins."
    },
    "trendline_breakout": {
      "trendline_window": 30,
      "volatility_window": 30,
      "breakout_threshold": 1.5,
      "min_r2": 0.5,
      "max_pvalue": 0.05,
      "max_positions": 10,
      "rebalance_days": 1,
      "weighting_method": "equal_weight",
      "long_allocation": 0.5,
      "short_allocation": 0.5,
      "_comment": "Optimal params from backtest (2020-2025): rebalance_days=1 (daily), holding_period=5 days, Total Return: +93.44%, Sharpe: 0.36. Momentum continuation strategy: long uptrend breakouts, short downtrend breakouts."
    },
    "volatility": {
      "volatility_window": 30,
      "num_quintiles": 10,
      "rebalance_days": 3,
      "long_percentile": 10,
      "short_percentile": 90,
      "weighting_method": "risk_parity",
      "long_allocation": 0.5,
      "short_allocation": 0.5,
      "_comment": "UPDATED 2025-11-04: Changed to DECILE (10%) with risk_parity. Backtest results: Sharpe 1.40, Total Return 1895.59%, Ann Return 87.73%, MaxDD -38.41%. DRAMATIC IMPROVEMENT over quintile (+29.9% Sharpe). Low volatility anomaly strongest in extreme deciles. Long stable coins, short volatile coins."
    },
    "kurtosis": {
      "kurtosis_window": 30,
      "rebalance_days": 14,
      "long_percentile": 20,
      "short_percentile": 80,
      "weighting_method": "risk_parity",
      "long_allocation": 0.5,
      "short_allocation": 0.5,
      "strategy_type": "mean_reversion",
      "regime_filter": "bear_only",
      "reference_symbol": "BTC/USD",
      "_comment": "REGIME-FILTERED STRATEGY - Only activates in BEAR MARKETS. Mean reversion: long low kurtosis (stable), short high kurtosis (volatile). Performance by regime: Bear/Low-Vol: +28% to +50% annualized (Sharpe 1.79), Bull markets: -25% to -90% annualized (TOXIC). Regime filter prevents activation in bull markets based on 50MA < 200MA on BTC. When inactive, the allocated capital (5%) is automatically redistributed to other flexible strategies (Size, ADF, Beta, Volatility, Mean Reversion). See docs/KURTOSIS_REGIME_ANALYSIS.md for full analysis."
    },
    "adf": {
      "_status": "ACTIVE - Available for use (set weight > 0 to enable)",
      "adf_window": 60,
      "regression": "ct",
      "volatility_window": 30,
      "rebalance_days": 7,
      "long_percentile": 20,
      "short_percentile": 80,
      "strategy_type": "trend_following_premium",
      "weighting_method": "risk_parity",
      "long_allocation": 0.5,
      "short_allocation": 0.5,
      "_comment": "Optimal params from backtest (2021-2025): Total Return: +126.29%, Sharpe: 0.49, Max DD: -50.60%. Risk parity weighting beat equal weight. Trend Following Premium: long trending coins (high ADF), short stationary coins (low ADF). Currently active with weight=0. Set weight > 0 to enable in portfolio.",
      "_backtest_results": {
        "trend_following_risk_parity": {
          "return": "126.29%",
          "sharpe": 0.49,
          "max_drawdown": "-50.60%"
        },
        "trend_following_equal_weight": {
          "return": "69.32%",
          "sharpe": 0.31,
          "max_drawdown": "-50.38%"
        },
        "mean_reversion_equal_weight": {
          "return": "-71.04%",
          "sharpe": -0.6,
          "max_drawdown": "-87.73%",
          "_note": "DO NOT USE - failed badly"
        }
      }
    },
    "leverage_inverted": {
      "_status": "TESTING - Set weight > 0 to enable (capped at 5%)",
      "rebalance_days": 7,
      "top_n": 10,
      "bottom_n": 10,
      "_comment": "TESTING STRATEGY - Short high-leverage coins, long low-leverage coins. Strategy caps applied at 5% in main.py for safety during testing phase."
    },
    "dilution": {
      "_status": "TESTING - Set weight > 0 to enable (capped at 5%)",
      "rebalance_days": 7,
      "lookback_months": 12,
      "top_n": 10,
      "volatility_window": 90,
      "long_allocation": 0.5,
      "short_allocation": 0.5,
      "_comment": "TESTING STRATEGY - Long low dilution coins, short high dilution coins. Token supply inflation factor. Strategy caps applied at 5% in main.py for safety during testing phase."
    },
    "turnover": {
      "_status": "ACTIVE - Exceptional backtest performance (Sharpe: 2.17)",
      "rebalance_days": 30,
      "long_percentile": 20,
      "short_percentile": 80,
      "weighting_method": "equal_weight",
      "long_allocation": 0.5,
      "short_allocation": 0.5,
      "_comment": "Turnover Factor (24h Volume / Market Cap). Long high turnover (liquid), short low turnover (illiquid). Backtest (2020-2025): Total Return: 118.61%, Sharpe: 2.17, Max DD: -11.69%, Win Rate: 66.67%. Excellent liquidity-based factor with institutional-grade Sharpe ratio."
    }
  }
}
